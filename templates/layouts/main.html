<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WorkHub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="icon" type="image/x-icon" href="/media/system_image/logo1.png" />
    <style>
      ::-webkit-scrollbar {
        display: none;
      }
      * {
        margin: 0;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    {% if messages %}
      <div id="messages" class="fixed shadow-sm top-20 right-2 z-50 space-y-3 max-w-md w-full translate-x-full opacity-0 transition-all duration-500 ease-out">
        {% for message in messages %}
          <div class="{% if message.tags == 'success' %}
              bg-white border-l-4 border-green-500
            {% elif message.tags == 'error' %}
              bg-white border-l-4 border-red-500
            {% elif message.tags == 'warning' %}
              bg-white border-l-4 border-yellow-500
            {% else %}
              bg-white border-l-4 border-blue-500
            {% endif %} rounded-lg shadow-xl p-4 flex items-start gap-3">
            <div class="flex-shrink-0">
              {% if message.tags == 'success' %}
                <i class="fas fa-check-circle text-green-500 text-xl"></i>
              {% elif message.tags == 'error' %}
                <i class="fas fa-times-circle text-red-500 text-xl"></i>
              {% elif message.tags == 'warning' %}
                <i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>
              {% else %}
                <i class="fas fa-info-circle text-blue-500 text-xl"></i>
              {% endif %}
            </div>
            <div class="flex-1 pt-0.5">
              <p class="text-md font-semibold text-gray-900">{{ message }}</p>
            </div>
            <button type="button" class="flex-shrink-0 ml-auto text-gray-400 hover:text-gray-600 transition-colors" onclick="this.closest('#messages').remove()"><i class="fas fa-times text-lg"></i></button>
          </div>
        {% endfor %}
      </div>
      <script>
        window.addEventListener('DOMContentLoaded', () => {
          const msg = document.getElementById('messages')
          if (!msg) return
          requestAnimationFrame(() => {
            msg.classList.remove('translate-x-full', 'opacity-0')
            msg.classList.add('translate-x-0', 'opacity-100')
          })
          setTimeout(() => {
            msg.classList.add('opacity-0', 'transition-opacity', 'duration-500')
            setTimeout(() => msg.remove(), 500)
          }, 3000)
        })
      </script>
    {% endif %}
    <nav class="fixed w-full z-50 bg-white shadow-md border-b-[6px] border-cyan-700 rounded-lg">
      <div class="mx-auto px-4 sm:px-6 lg:px-8 ml-[5%] mr-[5%]">
        <div class="grid grid-cols-4 items-center h-16">
          <a href="/" class="flex items-center gap-2">
            <img class="h-10 w-10" src="/media/system_image/logo1.png" alt="Logo" />
            <h1 class="hidden md:block text-2xl font-bold text-cyan-600">WorkHub</h1>
          </a>
          {% if request.user.is_authenticated %}
            <div class="col-span-2 relative">
              <form method="GET" action="/jobs" class="flex items-center">
                <input type="text" name="search" placeholder="Search jobs..." value="{{ request.GET.search }}" class="w-[100%] pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-sm" />
                <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <button type="submit" class="absolute right-2 top-1/2 -translate-y-1/2 px-3 py-1 bg-cyan-600 text-white text-xs rounded-md hover:bg-cyan-700 transition duration-300">Go</button>
              </form>
            </div>
            <div class="hidden md:flex items-center space-x-8 ms-auto">
              <a href="/dashboard" class="mt-auto flex flex-col space-y-2 items-center text-gray-700 hover:text-cyan-600 transition duration-300">
                <i class="fa fa-xl fa-home"></i>
                <span class="">Home</span>
              </a>
              <a href="/jobs" class="mt-auto flex flex-col space-y-2 items-center text-gray-700 hover:text-cyan-600 transition duration-300">
                <i class="fa-solid fa-xl fa-briefcase"></i>
                <span class="">Jobs</span>
              </a>
              <div class="relative" id="profileDropdown">
                <button type="button" onclick="toggleDropdown()" class="flex items-center gap-2 focus:outline-none">
                  <img src="{{ request.user.profile.profile_image.url }}" alt="{{ user.username }}" class="w-12 h-12 rounded-full bg-gray-100 border-2 border-white shadow-lg object-cover hover:border-cyan-600 hover:scale-[1.05] transition duration-300 cursor-pointer" />
                  <i id="dropdownArrow" class="fas fa-chevron-down text-gray-600 text-sm transition-transform duration-300"></i>
                </button>
                <div id="dropdownMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 py-2 opacity-0 scale-95 transition-all duration-200 origin-top-right">
                  <div class="px-4 py-3 border-b border-gray-200">
                    <p class="text-sm font-semibold text-gray-900">{{ request.user.get_full_name|default:request.user.username }}</p>
                    <p class="text-xs text-gray-500 truncate">{{ request.user.email }}</p>
                  </div>
                  <a href="/user/profile" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-cyan-50 hover:text-cyan-600 transition duration-200">
                    <i class="fas fa-user mr-3 w-4"></i>
                    <span>Profile</span>
                  </a>
                  <a href="/company/pages" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-cyan-50 hover:text-cyan-600 transition duration-200">
                    <i class="fa-solid fa-briefcase mr-3 w-4"></i>
                    <span>Company Page</span>
                  </a>
                  <a href="/user/logout" class="flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition duration-200">
                    <i class="fas fa-sign-out-alt mr-3 w-4"></i>
                    <span>Logout</span>
                  </a>
                </div>
              </div>
            </div>
          {% else %}
            <div class="hidden md:flex items-center space-x-4">
              <a href="/user/login" class="border-b-2 border-cyan-100 rounded-lg px-6 py-2 hover:shadow-md hover:shadow-cyan-200 text-gray-700 font-semibold hover:text-cyan-600 transition duration-300">LOG IN</a>
              <a href="/user/register" class="bg-cyan-600 text-white px-6 py-2 rounded-lg hover:bg-cyan-700 transition duration-300">Get Started</a>
            </div>
          {% endif %}
        </div>
      </div>
    </nav>
    <div class="flex flex-col pt-16 pb-4 min-h-[80vh]">
      {% block content %}

      {% endblock %}
    </div>
    <footer class="bg-cyan-600 text-white py-6">
      <div class="shadow-lg pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="mx-auto">
            <h3 class="text-2xl font-bold mb-4">WorkHub</h3>
            <p class="">AI-powered job matching platform connecting talent with opportunity.</p>
          </div>
          <div class="mx-auto">
            <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
            <ul class="space-y-2">
              <li>
                <a href="#" class="hover:text-green-400 transition duration-300">Browse Jobs</a>
              </li>
              <li>
                <a href="#" class="hover:text-green-400 transition duration-300">Career Resources</a>
              </li>
              <li>
                <a href="#" class="hover:text-green-400 transition duration-300">Success Stories</a>
              </li>
              <li>
                <a href="#" class="hover:text-green-400 transition duration-300">Hiring Guide</a>
              </li>
            </ul>
          </div>
          <div class="mx-auto">
            <h4 class="text-lg font-semibold mb-4">Company</h4>
            <ul class="space-y-2">
              <li>
                <a href="#" class="hover:text-green-400 transition duration-300">About Us</a>
              </li>
              <li>
                <a href="#" class="hover:text-green-400 transition duration-300">Contact</a>
              </li>
              <li>
                <a href="#" class="hover:text-green-400 transition duration-300">Privacy Policy</a>
              </li>
              <li>
                <a href="#" class="hover:text-green-400 transition duration-300">Terms of Service</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="mt-8 text-center">
        <p>&copy; 2025 WorkHub. All rights reserved. Powered by AI.</p>
      </div>
    </footer>

    <script>
      // Dropdown toggle function
      function toggleDropdown() {
        const dropdown = document.getElementById('dropdownMenu')
        const arrow = document.getElementById('dropdownArrow')
      
        if (dropdown.classList.contains('hidden')) {
          // Show dropdown with animation
          dropdown.classList.remove('hidden')
          setTimeout(() => {
            dropdown.classList.remove('opacity-0', 'scale-95')
            dropdown.classList.add('opacity-100', 'scale-100')
          }, 10)
          arrow.classList.add('rotate-180')
        } else {
          // Hide dropdown with animation
          dropdown.classList.remove('opacity-100', 'scale-100')
          dropdown.classList.add('opacity-0', 'scale-95')
          setTimeout(() => {
            dropdown.classList.add('hidden')
          }, 200)
          arrow.classList.remove('rotate-180')
        }
      }
      
      // Close dropdown when clicking outside
      document.addEventListener('click', function (event) {
        const dropdownContainer = document.getElementById('profileDropdown')
        const dropdownMenu = document.getElementById('dropdownMenu')
        const arrow = document.getElementById('dropdownArrow')
      
        if (dropdownContainer && !dropdownContainer.contains(event.target)) {
          if (!dropdownMenu.classList.contains('hidden')) {
            dropdownMenu.classList.remove('opacity-100', 'scale-100')
            dropdownMenu.classList.add('opacity-0', 'scale-95')
            setTimeout(() => {
              dropdownMenu.classList.add('hidden')
            }, 200)
            arrow.classList.remove('rotate-180')
          }
        }
      })
      
      // Close dropdown when pressing Escape key
      document.addEventListener('keydown', function (event) {
        if (event.key === 'Escape') {
          const dropdownMenu = document.getElementById('dropdownMenu')
          const arrow = document.getElementById('dropdownArrow')
      
          if (!dropdownMenu.classList.contains('hidden')) {
            dropdownMenu.classList.remove('opacity-100', 'scale-100')
            dropdownMenu.classList.add('opacity-0', 'scale-95')
            setTimeout(() => {
              dropdownMenu.classList.add('hidden')
            }, 200)
            arrow.classList.remove('rotate-180')
          }
        }
      })
    </script>
  </body>
</html>
